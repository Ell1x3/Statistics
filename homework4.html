<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homework 4 - Legge dei Grandi Numeri - Gaia Diodati</title>
  <!-- Import di Chart.js per i grafici -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Import per il plugin di annotazione di Chart.js (per la linea del 50%) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/1.4.0/chartjs-plugin-annotation.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;600&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');

    body {
      margin: 0;
      font-family: 'Rajdhani', sans-serif;
      color: #fff5cc;
      background: #050505;
      overflow-x: hidden;
    }

    canvas#bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .hero {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 0 4vw;
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.2rem, 8vw, 5rem);
      letter-spacing: 3px;
      text-transform: uppercase;
      color: #e6b800;
      position: relative;
      text-shadow: 0 0 8px #ffcc00, 0 0 16px #ffaa00, 2px 2px 35px rgba(255,200,0,0.8);
      animation: glowPulse 4s ease-in-out infinite, glitch 2s infinite;
      margin: 0 0 12px;
    }

    h1::before, h1::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      color: #ffaa00;
      background: transparent;
      overflow: hidden;
    }

    h1::before {
      left: 2px;
      text-shadow: -2px 0 #ff33cc;
      animation: glitchShift 2s infinite linear alternate-reverse;
    }

    h1::after {
      left: -2px;
      text-shadow: 2px 0 #00ffcc;
      animation: glitchShift 3s infinite linear alternate;
    }

    h2 {
      font-size: clamp(1.2rem, 4vw, 2rem);
      color: #ffd966;
      margin: 6px 0;
    }
    
    /* Stile H2 specifico per i post-card */
    .post-card h2 {
      font-family: 'Orbitron', sans-serif;
      color: #ffaa00;
      margin-bottom: 10px;
      font-size: clamp(1.2rem, 4vw, 1.6rem);
    }
    
    .post-card h4 {
        font-family: 'Orbitron', sans-serif; 
        color: #ffaa00; 
        margin-bottom: 10px; 
        font-size: 1.1rem;
    }

    .subtitle {
      font-size: clamp(0.9rem, 3vw, 1rem);
      color: #fff3cc;
      opacity: 0.9;
      line-height: 1.5;
    }

    @keyframes glitchShift {
      0% { clip-path: inset(0 0 90% 0); }
      20% { clip-path: inset(10% 0 70% 0); }
      40% { clip-path: inset(40% 0 30% 0); }
      60% { clip-path: inset(60% 0 10% 0); }
      80% { clip-path: inset(80% 0 0 0); }
      100% { clip-path: inset(0 0 100% 0); }
    }

    @keyframes glowPulse {
      0%, 100% { text-shadow: 0 0 8px #ffcc00, 0 0 20px #ffaa00, 0 0 40px #ffcc33; }
      50% { text-shadow: 0 0 15px #ffee88, 0 0 35px #ffaa00, 0 0 60px #ffd966; }
    }

    @keyframes glitch {
      0%, 100% { transform: none; }
      92% { transform: translate(-1px, 1px) skew(0.3deg); }
      94% { transform: translate(1px, -1px) skew(-0.3deg); }
      96% { transform: translate(-2px, 1px) skew(0.5deg); }
      98% { transform: translate(2px, -1px) skew(-0.5deg); }
    }

    .posts {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 50px 5vw 70px;
      gap: 25px;
      background: rgba(20, 20, 20, 0.8);
    }

    .post-card {
      width: 90%;
      max-width: 700px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 200, 0, 0.3);
      border-radius: 12px;
      padding: 22px;
      text-align: left;
      backdrop-filter: blur(6px);
      transition: all 0.3s ease;
    }

    .post-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 25px rgba(255, 200, 0, 0.3);
    }

    .post-card p {
      color: #fff3cc;
      font-size: clamp(0.9rem, 2.8vw, 1rem);
      line-height: 1.6;
      margin-bottom: 12px;
    }
    
    .post-card p code {
        color: #ffcc00;
        background: rgba(0,0,0,0.2);
        padding: 2px 5px;
        border-radius: 4px;
        font-family: 'Roboto Mono', monospace;
    }

    .post-card a {
      display: inline-block;
      margin-top: 12px;
      color: #ffaa00;
      text-decoration: none;
      border: 1px solid #ffaa00;
      padding: 7px 14px;
      border-radius: 999px;
      font-size: clamp(0.85rem, 3vw, 1rem);
      transition: all 0.3s ease;
    }

    .post-card a:hover {
      background: #ffaa00;
      color: #000;
    }
    
    /* --- INIZIO STILI PER SIMULAZIONE --- */
    
    .post-card label {
      display: block;
      font-family: 'Orbitron', sans-serif;
      color: #ffaa00;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }
    
    .post-card input[type="number"],
    .post-card textarea {
      width: 100%;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255, 200, 0, 0.3);
      color: #fff3cc;
      padding: 10px;
      border-radius: 8px;
      font-family: 'Rajdhani', sans-serif;
      font-size: 1rem;
      margin-bottom: 12px;
      box-sizing: border-box; /* Importante per 100% width */
    }
    
    .post-card button {
      display: inline-block;
      width: 100%;
      margin-top: 12px;
      margin-bottom: 12px;
      color: #ffaa00;
      text-decoration: none;
      border: 1px solid #ffaa00;
      background: transparent;
      padding: 10px 14px;
      border-radius: 999px;
      font-size: 1rem;
      font-family: 'Orbitron', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .post-card button:hover {
      background: #ffaa00;
      color: #000;
    }
    
    #results {
        background: rgba(0,0,0,0.3);
        border: 1px solid rgba(255, 200, 0, 0.3);
        padding: 12px;
        border-radius: 8px;
        min-height: 50px;
        font-size: 1rem;
        line-height: 1.5;
        font-family: 'Roboto Mono', monospace;
    }
    
    /* --- FINE STILI PER SIMULAZIONE --- */
    
  </style>
</head>
<body>
  <canvas id="bg"></canvas>

  <div class="hero">
    <h1 data-text="Homework 4">Homework 4</h1>
    <h2>La Legge dei Grandi Numeri</h2>
    <p class="subtitle">Gaia Diodati – Matricola 2279030<br>Corso Magistrale in Cyber Security – Sapienza</p>
  </div>

  <section class="posts">
  
    <!-- Card 1: Spiegazione -->
    <div class="post-card">
      <h2>La Legge dei Grandi Numeri</h2>
      <p>La Legge dei Grandi Numeri è un teorema fondamentale della statistica. In termini semplici, afferma che se ripeti un esperimento (come lanciare una moneta) un numero molto elevato di volte, la media dei risultati che ottieni si avvicinerà sempre di più al valore atteso (la probabilità teorica).</p>
      <p>Per il lancio di una moneta non truccata, la probabilità teorica di ottenere "1" (Testa) è 0.5 (o 50%). Questo non significa che se lanci la moneta 10 volte otterrai esattamente 5 teste. Potresti ottenerne 3, o 7. Ma se la lanci <strong>1.000.000 di volte</strong>, è quasi garantito che il numero di teste sarà molto, molto vicino a 500.000, e la frequenza osservata (<code>Teste / Totale Lanci</code>) sarà estremamente vicina a 0.5.</p>
    </div>
    
    <!-- Card 2: La Simulazione -->
    <div class="post-card">
      <h2>Simulazione del Lancio di Moneta</h2>
      <p>Questa simulazione esegue un "lancio di moneta" generando un numero casuale tra 0 e 1. Se il numero è <code>< 0.5</code>, lo contiamo come "0" (Croce). Se è <code>>= 0.5</code>, lo contiamo come "1" (Testa). Eseguiamo questo esperimento <code>N</code> volte e visualizziamo i risultati in due grafici.</p>
      
      <div>
        <label for="numTrials">1. Numero di Lanci (N):</label>
        <input type="number" id="numTrials" value="1000">
      </div>
      <div>
        <button id="runSimulationBtn">Esegui Simulazione</button>
      </div>
      
      <hr style="border-color: rgba(255, 200, 0, 0.3); margin: 20px 0;">
      
      <h4>Risultati della Simulazione:</h4>
      <div id="results">I risultati appariranno qui...</div>
      
      <h4 style="margin-top: 20px;">Grafico 1: Random Walk (Somma Cumulativa di "1")</h4>
      <p>Questo grafico mostra l'accumulo di "Teste" (1) nel tempo. La linea sale di 1 ogni volta che esce "1" e rimane orizzontale quando esce "0", come richiesto.</p>
      <div style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px; margin-top: 10px;">
        <canvas id="walkChart"></canvas>
      </div>
      
      <h4 style="margin-top: 20px;">Grafico 2: Convergenza della Probabilità (Legge dei Grandi Numeri)</h4>
      <p>Questo grafico dimostra la legge. Mostra la frequenza osservata (<code>Totale Teste / Lanci Effettuati</code>) ad ogni passo. Come puoi vedere, dopo un'incertezza iniziale, la linea "si allinea" e converge stabilmente verso la probabilità reale del 50% (la linea rossa tratteggiata).</p>
      <div style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px; margin-top: 10px;">
        <canvas id="probChart"></canvas>
      </div>
    </div>

    <!-- Card 3: Conclusione -->
     <div class="post-card">
      <h2>Conclusione</h2>
      <p>Questa simulazione dimostra visivamente perché la statistica è così potente. Anche se i singoli eventi (un lancio di moneta) sono imprevedibili, il comportamento aggregato di <strong>molti</strong> eventi (migliaia di lanci) diventa estremamente prevedibile. La casualità a breve termine si trasforma in stabilità a lungo termine.</p>
      <p>Questo è lo stesso principio usato in cybersecurity per distinguere il normale traffico di rete (milioni di pacchetti che seguono uno schema) da un'anomalia (un attacco che devia da quello schema).</p>
      <a href="index.html">← Torna all'Indice</a>
    </div>
  </section>

  <script>
    // --- SCRIPT 1: Animazione Canvas Sfondo ---
    const canvas = document.getElementById('bg');
    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const points = [];
    const numPoints = 100;

    for (let i = 0; i < numPoints; i++) {
      points.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        vx: (Math.random() - 0.5) * 0.6,
        vy: (Math.random() - 0.5) * 0.6
      });
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < points.length; i++) {
        const p1 = points[i];
        for (let j = i + 1; j < points.length; j++) {
          const p2 = points[j];
          const dx = p1.x - p2.x;
          const dy = p1.y - p2.y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < 130) {
            ctx.strokeStyle = `rgba(255, 200, 0, ${(1 - dist / 130) * 0.15})`;
            ctx.beginPath();
            ctx.moveTo(p1.x, p1.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.stroke();
          }
        }

        p1.x += p1.vx;
        p1.y += p1.vy;
        if (p1.x < 0 || p1.x > canvas.width) p1.vx *= -1;
        if (p1.y < 0 || p1.y > canvas.height) p1.vy *= -1;

        ctx.beginPath();
        ctx.arc(p1.x, p1.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = '#ffcc00';
        ctx.fill();
      }
      requestAnimationFrame(draw);
    }
    draw();
    
    // --- SCRIPT 2: Logica Simulazione Legge Grandi Numeri ---
    document.addEventListener('DOMContentLoaded', () => {

        const trialsInput = document.getElementById('numTrials');
        const runBtn = document.getElementById('runSimulationBtn');
        const resultsDiv = document.getElementById('results');
        const walkCanvas = document.getElementById('walkChart');
        const probCanvas = document.getElementById('probChart');
        
        let walkChart = null;
        let probChart = null;

        const runSimulation = () => {
            try {
                const numTrials = parseInt(trialsInput.value);
                if (numTrials <= 0) {
                    resultsDiv.innerHTML = `<span style="color: #ff6b6b;">Inserisci un numero di lanci valido.</span>`;
                    return;
                }

                let heads = 0;
                let tails = 0;
                
                const walkData = [0]; // Dati per Grafico 1 (Random Walk)
                const probData = []; // Dati per Grafico 2 (Convergenza)
                const labels = []; // Etichette per l'asse X

                for (let i = 1; i <= numTrials; i++) {
                    const toss = Math.random();
                    let result = 0;
                    
                    if (toss >= 0.5) {
                        result = 1;
                        heads++;
                    } else {
                        result = 0;
                        tails++;
                    }
                    
                    // Grafico 1: Aggiungi 1 se è testa, 0 se è croce
                    const lastValue = walkData[walkData.length - 1];
                    walkData.push(lastValue + result);
                    
                    // Grafico 2: Calcola la probabilità corrente
                    const currentProb = heads / i;
                    probData.push(currentProb);
                    
                    labels.push(i);
                }

                // Aggiorna i risultati
                const observedProb = (heads / numTrials) * 100;
                resultsDiv.innerHTML = `Lanci Totali: <b style="color: #ffaa00;">${numTrials}</b><br>` +
                                     `Teste (1): <b style="color: #ffaa00;">${heads}</b><br>` +
                                     `Croci (0): <b style="color: #ffaa00;">${tails}</b><br>` +
                                     `Frequenza Osservata di "1": <b style="color: #00ffcc;">${observedProb.toFixed(4)}%</b>`;

                // Aggiorna i grafici
                updateCharts(labels, walkData, probData);

            } catch (err) {
                resultsDiv.innerHTML = `<span style="color: #ff6b6b;">Errore: ${err.message}</span>`;
            }
        };
        
        const updateCharts = (labels, walkData, probData) => {
            // Distruggi i grafici esistenti se ci sono
            if (walkChart) {
                walkChart.destroy();
            }
            if (probChart) {
                probChart.destroy();
            }
            
            // --- Grafico 1: Random Walk ---
            walkChart = new Chart(walkCanvas, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Somma Cumulativa di "1" (Teste)',
                        data: walkData.slice(1), // Rimuovi lo 0 iniziale per allineare
                        borderColor: 'rgba(255, 170, 0, 1)', // #ffaa00
                        backgroundColor: 'rgba(255, 170, 0, 0.3)',
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.1
                    }]
                },
                options: {
                    scales: {
                        y: { ticks: { color: '#fff3cc' }, grid: { color: 'rgba(255, 200, 0, 0.15)' } },
                        x: { ticks: { color: '#fff3cc' }, grid: { color: 'rgba(255, 200, 0, 0.15)' } }
                    },
                    plugins: { legend: { labels: { color: '#fff3cc' } } }
                }
            });
            
            // --- Grafico 2: Convergenza Probabilità ---
            probChart = new Chart(probCanvas, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Frequenza Osservata di "1"',
                            data: probData,
                            borderColor: 'rgba(0, 255, 204, 1)', // #00ffcc
                            backgroundColor: 'rgba(0, 255, 204, 0.3)',
                            borderWidth: 2,
                            pointRadius: 0,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    scales: {
                        y: { 
                            min: 0, 
                            max: 1,
                            ticks: { color: '#fff3cc' }, 
                            grid: { color: 'rgba(255, 200, 0, 0.15)' } 
                        },
                        x: { 
                            ticks: { color: '#fff3cc' }, 
                            grid: { color: 'rgba(255, 200, 0, 0.15)' } 
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#fff3cc' } },
                        // Aggiungiamo la linea del 50%
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 0.5,
                                    yMax: 0.5,
                                    borderColor: 'rgba(255, 50, 50, 0.8)',
                                    borderWidth: 2,
                                    borderDash: [10, 5],
                                    label: {
                                        content: 'Probabilità Reale (50%)',
                                        enabled: true,
                                        position: 'start',
                                        color: 'rgba(255, 50, 50, 0.8)'
                                    }
                                }
                            }
                        }
                    }
                },
                // Registra il plugin
                plugins: [ChartDataLabels]
            });
             // Registra il plugin di annotazione globalmente (necessario una volta)
             //Chart.register(window.ChartAnnotation);
        };

        runBtn.addEventListener('click', runSimulation);
        runSimulation(); // Esegui al caricamento della pagina
    });
  </script>
</body>
</html>